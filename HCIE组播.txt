组播
组播MAC地址总共48bit
  1、前24bit固定0x01005e
  2、第二十五比特固定位：0
  3、后23bit从组播IP地址的后23bit直接填充
  4、组播IP的中后28bit只有最后23bit对应到了组播MAC地址上，
     所以5bit没有对应，会出现，多个IP对应一个组播地址的现象


 组播协议
 IGMP协议-网络层协议-协议号2
 在PIM网络中最后一跳路由器和组成员维护成员关系
 周期询问路由器下属成员有没有要加入组的
 
 IGMPV1

 IGMPV2

 IGMPV3（运行在SSM模型中）


PI-SM
为什么要SPT树切换
PIM网络多路径，如过所有的流量都经过SPT树转发个RP，再由RP中转至RPT树，最终转发给接受者
1、由最后一跳DR执行SPT树切换
（默认启用，触发条件：最后一跳DR需要接收到组播数据，1Kbit）

SG表项是有SG加入触发形成的，发生在源树上
SPT树切换好之后，可能会有分叉点，做RPF检查，失败的一方，会修剪他的SG表项

匹配规则
基于单播路由表
直连
静态
RIP
OSPF
IS-IS
BGP
1、最长匹配原则
2、优先级，越小越优先
3、cost，越小越优先
4、负载均衡，下一条地址大的


RP发现
一个RP可以为多个组播服务
一个组只能对用一个RP

动态RP工作机制：
1 C-BSR：备份自举路由器；可以再PIM网络上配置多个；
  最终只能选择一个BSR，全网必须得知C-BSR的位置信息（路由表中）

2 C-BSR每周期60秒向PIM邻居发送自举消息，逐条的在去全网泛洪扩散，最终去哪网PIM路由器都能
学习到C-BSR，有多个C-BSR时，选举一个BSR 可以抢占 选举规则：先比优先级>IP地址大的优先>

为什么需要BSR：管理收集RP信息
1、管理RP---->搜集全网的C-RP信息
2、得知BSR信息后，全网C-RP，将自己的RP信息大伯发送给BSR，
BSR收集到信息后放入自举消息中，每隔60秒发送，全网的PIM路由
器都会受到BSR发送的信息，用一样的规则选举出RP
RP选举规则：
1、比较RP所服务的组范围，越精确越优，默认为所有的组服务
2、比较CRP的优先级，越大越优先，默认为0
3、比较HASH函数，越大越优
4、比较C-RP地址，越大越优
BSR中的HASH掩码的作用：
1、当做素材参与C-RP的选举
2、可以实现RP选举的负载分担

